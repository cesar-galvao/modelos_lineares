[
  {
    "objectID": "questao2.html",
    "href": "questao2.html",
    "title": "Questão 2",
    "section": "",
    "text": "This is a Quarto website.\nTo learn more about Quarto websites visit https://quarto.org/docs/websites."
  },
  {
    "objectID": "questao1.html",
    "href": "questao1.html",
    "title": "Questão 1",
    "section": "",
    "text": "Analisaremos o banco de dados prostate do pacote faraway, em que constam dados de estudo prospectivo com 97 homens com câncer de próstata.\nCode\npacman::p_load(tidyverse, faraway, psych, tidymodels)\n\ndata(prostate)\nA variável resposta neste caso é logaritmo do antígeno prostático específico da próstata (lpsa). As covariáveis observadas são: logaritmo do volume do câncer (lcavol), logaritmo do peso da próstata (lweight), idade (age), logaritmo da quantidade de hiperplasia prostática (benignalbph), invasão da vesícula seminal (svi), logaritmo da penetração capsular (lcp), escore de Gleason (gleason), e escore percentual de Gleason 4 ou 5 (pgg45)."
  },
  {
    "objectID": "questao1.html#análise-exporatória",
    "href": "questao1.html#análise-exporatória",
    "title": "Questão 1",
    "section": "Análise exporatória",
    "text": "Análise exporatória\nIniciamos a análise exploratória com uma avaliação gráfica da distribuição das variáveis disponíveis. Aqui, as variáveis age e pgg45 foram separadas para que não distorcessem a escala das demais variáveis ilustradas.\nDentre o primeiro grupo de variáveis, pode-se destacar uma maior assimetria positiva em gleason e lcp, assim como uma dispersão muito pequena em lweight e svi. Quanto às últimas, é esperada uma pequena variação de lweight já que se trata de um órgão humano e svi é uma variável dicotômica.\n\n\nCode\nprostate %&gt;%\n  select(-age, -pgg45)%&gt;%\n  pivot_longer(everything(), names_to = \"variavel\") %&gt;%\n  ggplot(aes(variavel, value))+\n  labs(x = \"\", y = \"\")+\n  geom_boxplot()+\n  stat_summary(fun=mean, geom=\"point\", shape=5, size=2, color=\"black\", fill=\"gray\")+\n  theme_minimal()\n\n\n\n\n\nBoxplot de variáveis do banco de dados\n\n\n\n\nJá em relação à variável age, notamos que a maioria dos indivíduos tem em torno de 60 anos. Ao mesmo tempo, vemos que a maioria dos indivíduos tem menos de 50% de escore percentual de Gleason 4 ou 5.\n\n\nCode\nprostate %&gt;%\n  select(age, pgg45)%&gt;%\n  pivot_longer(everything(), names_to = \"variavel\") %&gt;%\n  ggplot(aes(variavel, value))+\n  labs(x = \"\", y = \"\")+\n  geom_boxplot()+\n  stat_summary(fun=mean, geom=\"point\", shape=5, size=2, color=\"black\", fill=\"gray\")+\n  theme_minimal()\n\n\n\n\n\nBoxplot de idade e escores de Gleason 4 ou 5\n\n\n\n\nA tabela com medidas resumo a seguir aponta as mesmas assimetrias avaliadas anteriormente e desvios-padrão altos – relativamente à escala de cada variável – para pgg45 e lbph. Notamos ainda que os indivíduos tem entre 41 e 79 anos de idade.\n\n\nCode\nmedidas &lt;- describe(prostate)\n\nnomes &lt;- row.names(medidas)\n\nmedidas %&gt;%\n  as_tibble() %&gt;%\n  mutate(vars = nomes) %&gt;%\n  select(vars, mean, median, sd, min, max, skew, kurtosis)%&gt;%\n  knitr::kable(\n    align = c(\"c\"),\n    booktabs = TRUE,\n    longtable = TRUE,\n    linesep = \"\",\n    escape = FALSE,\n    digits = 2,\n    col.names = c(\"\", \"Média\", \"Mediana\", \"Desv.Pad\", \"Mín\", \"Máx\", \"Skew.\",\"Kurt.\")\n    ) %&gt;%\n  kableExtra::kable_styling(\n      position = \"center\",\n      latex_options = c(\"striped\", \"repeat_header\"),\n      stripe_color = \"gray!15\")\n\n\n\nMedidas resumo da base de dados \n\n\n\nMédia\nMediana\nDesv.Pad\nMín\nMáx\nSkew.\nKurt.\n\n\n\n\nlcavol\n1.35\n1.45\n1.18\n-1.35\n3.82\n-0.24\n-0.60\n\n\nlweight\n3.65\n3.62\n0.50\n2.37\n6.11\n1.18\n5.02\n\n\nage\n63.87\n65.00\n7.45\n41.00\n79.00\n-0.80\n0.96\n\n\nlbph\n0.10\n0.30\n1.45\n-1.39\n2.33\n0.13\n-1.75\n\n\nsvi\n0.22\n0.00\n0.41\n0.00\n1.00\n1.36\n-0.16\n\n\nlcp\n-0.18\n-0.80\n1.40\n-1.39\n2.90\n0.71\n-1.01\n\n\ngleason\n6.75\n7.00\n0.72\n6.00\n9.00\n1.22\n2.36\n\n\npgg45\n24.38\n15.00\n28.20\n0.00\n100.00\n0.94\n-0.37\n\n\nlpsa\n2.48\n2.59\n1.15\n-0.43\n5.58\n0.00\n0.43"
  },
  {
    "objectID": "questao1.html#ajuste-de-modelo",
    "href": "questao1.html#ajuste-de-modelo",
    "title": "Questão 1",
    "section": "Ajuste de Modelo",
    "text": "Ajuste de Modelo\nIniciamos um ajuste de regressão linear utilizando a função lm() do pacote stats utilizando todas as variáveis. Para seleção de algum modelo com melhor desempenho sem a estimação de todos os parâmetros, utilizamos MASS::stepAIC() para uma seleção automática de covariáveis e terminamos com o seguinte modelo, que apresenta R^2= 0.64:\n\n\\begin{aligned}\n  \\hat{\\text{lpsa}} &= \\hat{\\beta_0} + \\hat{\\beta_1} \\, \\text{lcavol} +\\hat{\\beta_2} \\, \\text{lweight} + \\hat{\\beta_3} \\, \\text{age} + \\hat{\\beta_4} \\, \\text{lbph} + \\hat{\\beta_5} \\, \\text{svi} \\\\\n   &= 0,951 + 0,565 \\, \\text{lcavol} + 0,423 \\, \\text{lweight} -0,014 \\, \\text{age} + 0,111 \\, \\text{lbph} + 0,721 \\, \\text{svi}.\n\\end{aligned}\n\nNo entanto, é possível ver na tabela a seguir que nem todos os coeficientes podem ser considerados significantes, de modo que reduzimos ainda mais o modelo.\n\n\nCode\ntidy(fit1) %&gt;%\n  knitr::kable(\n    align = c(\"c\"),\n    booktabs = TRUE,\n    longtable = TRUE,\n    linesep = \"\",\n    escape = FALSE,\n    digits = 3\n    ) %&gt;%\n  kableExtra::kable_styling(\n      position = \"center\",\n      latex_options = c(\"striped\", \"repeat_header\"),\n      stripe_color = \"gray!15\")\n\n\n\n\n\nterm\nestimate\nstd.error\nstatistic\np.value\n\n\n\n\n(Intercept)\n0.951\n0.832\n1.143\n0.256\n\n\nlcavol\n0.566\n0.075\n7.583\n0.000\n\n\nlweight\n0.424\n0.167\n2.539\n0.013\n\n\nage\n-0.015\n0.011\n-1.385\n0.170\n\n\nlbph\n0.112\n0.058\n1.927\n0.057\n\n\nsvi\n0.721\n0.209\n3.449\n0.001\n\n\n\n\n\n\n\nCode\nfit2 &lt;- lm(lpsa ~ lcavol + lweight + svi + 0 , data = prostate)\n\n\nQuando consideramos apenas as covariáveis para as quais temos significância a 5%, ficamos com um modelo final da seguinte forma com R^2= 0.93:\n\n\\begin{aligned}\n  \\hat{\\text{lpsa}} &= \\hat{\\beta_1} \\, \\text{lcavol} + \\hat{\\beta_2} \\, \\text{lweight} + \\hat{\\beta_5} \\, \\text{svi} \\\\\n   &=  0,552 \\, \\text{lcavol} + 0,436 \\, \\text{lweight}  + 0,668 \\, \\text{svi}.\n\\end{aligned}\n\n\nAnálise de Variância\nPara construir a tabela da análise de variância, construimos primeiro apenas o modelo com intercepto e depois comparamos ao modelo selecionado na etapa anterior. A tabela de ANOVA é apresentada na tabela a seguir.\n\n\nCode\n#modelo só com intercepto\nfit0 &lt;- lm(lpsa ~ 1, data = prostate)\n\n#tabela diretamente de anova()\ntabela &lt;- anova(fit2, fit0) %&gt;% \n  as_tibble() %&gt;%\n  select(\"gl\" = Res.Df, \"SQ\" = RSS)\n\n#Correção dos graus de liberdade\ntabela$gl &lt;- c(nrow(prostate)-length(coef(fit2)), nrow(prostate))\n\n#montando a fonte de variacao do modelo\nmodelo &lt;- tibble(gl = tabela$gl[2] - tabela$gl[1] + 1, SQ = tabela$SQ[2] - tabela$SQ[1])\n\n#arrumando a tabela\ntabela_qm &lt;- tabela %&gt;%\n  bind_rows(modelo) %&gt;%\n  arrange(gl) %&gt;%\n  mutate(Fonte = c(\"Regressão\", \"Resíduo\", \"Total\"),\n         QM = SQ/gl) %&gt;%\n  select(Fonte, everything())\n\n# Calculando F_0 e pvalor do teste\nF0 &lt;- c(tabela_qm$QM[1]/tabela_qm$QM[2], NA, NA)\npval &lt;- pf(F0, df1=tabela_qm$gl[1], df2=tabela_qm$gl[2], lower.tail = FALSE)\n\ntabela_anova &lt;- tabela_qm %&gt;% bind_cols(\"F\" = F0,\"pval\" = pval)\n\noptions(knitr.kable.NA = '')\n\ntabela_anova %&gt;%\n  knitr::kable(\n    align = c(\"c\"),\n    booktabs = TRUE,\n    longtable = TRUE,\n    linesep = \"\",\n    escape = FALSE,\n    digits = 2,\n    col.names = c(\"Fonte\", \"g.l.\", \"SQ\", \"QM\", \"F\", \"p-valor\")\n    ) %&gt;%\n  kableExtra::kable_styling(\n      position = \"center\",\n      latex_options = c(\"striped\", \"repeat_header\"),\n      stripe_color = \"gray!15\")\n\n\n\n\n\nFonte\ng.l.\nSQ\nQM\nF\np-valor\n\n\n\n\nRegressão\n4\n80.01\n20.00\n39.24\n0\n\n\nResíduo\n94\n47.91\n0.51\n\n\n\n\nTotal\n97\n127.92\n1.32\n\n\n\n\n\n\n\n\n\nConclui-se, pelo resultado do teste F (o p-valor apresentado na tabela é muito próximo de zero e por isso é arredondado para zero) que há pelo menos um dos coeficientes do modelo diferente de zero a um nível inferior a 0,001% de significância.\n\n\nAvaliação da variância\nComparando os valores ajustados da resposta com os resíduos Studentizados, os pontos parecem ter comportamento aleatório em torno do zero, sem indicação de mudança na variação dos pontos em algum intervalo de \\hat{Y}. Podemos dizer portanto que não há indícios contra a suposição de homocedasticiade do modelo.\n\n\nCode\ntibble(\n  ajustados = fitted(fit2),\n  res_stu = stats::rstudent(fit2)\n) %&gt;%\n  ggplot(aes(ajustados, res_stu))+\n  geom_point() +\n  theme_bw()+\n  labs(x = \"Resposta ajustada\", y = \"Resíduos Studentizados\")\n\n\n\n\n\n\n\nSuposição de normalidade\nAvalia-se a suposição de normalidade dos resíduos comparando os resíduos Studentizados com os quantis da distribuição Normal, tal qual um qqplot, porém com uma banda de confiança obtida via bootstrap paramétrico.\nObserva-se que alguns dos pontos de fato parecem margear os limites da banda de confiança, mas estão muito próximos. Afirma-se portanto que não há fuga da suposição de normalidade dos resíduos e, portanto, da resposta.\n\n\nCode\nsource(\"envelope_function.R\")\n\nenvelope_LR(fit2, OLS = T, main.title = \"Gráfico dos resíduos com envelope\") \n\n\n\n\n\n\n\nInterpretação do modelo\nForam conferidos, portanto, os pressupostos do modelo, de modo que se pode modelar o logaritmo do antígeno prostático específico (lpsa) em função de (1) logaritmo do volume do câncer (lcavol), (2) logaritmo do peso da próstata (lweight) e (5) invasão ou não da vesícula seminal (svi) da seguite forma:\n\n\\begin{aligned}\n  \\hat{\\text{lpsa}} &= \\hat{\\beta_1} \\, \\text{lcavol} + \\hat{\\beta_2} \\, \\text{lweight} + \\hat{\\beta_5} \\, \\text{svi} \\\\\n   &=  0,552 \\, \\text{lcavol} + 0,436 \\, \\text{lweight}  + 0,668 \\, \\text{svi}.\n\\end{aligned}\n\nEm outros termos, o aumento em uma unidade em alguma das covariáveis X_i aumenta em \\beta_i o logaritmo do antígeno prostático específico.\n\n\nIntervalos de confiança para \\hat{\\beta_i}\n\n\nCode\nX &lt;- prostate %&gt;%\n  select(lcavol, lweight, svi) %&gt;%\n  as.matrix()\n\ninvXtX &lt;- solve(t(X) %*% X)\n\n\nConsideramos que neste caso \\hat{\\beta} \\sim N_3\\left( \\beta, \\sigma^2(X^\\top X)^{-1} \\right). Usamos \\hat{\\sigma^2} como o quadrado médio do resíduo para estimar \\sigma^2. A variância de \\hat{\\beta} portanto é\n\n\\hat{\\sigma^2}(X^\\top X)^{-1} = 0.51 \\cdot\n\\begin{bmatrix}\n0.0108 & -0.0030 & -0.0161\\\\\n-0.0030 & 0.0018 & 0.0008 \\\\\n-0.0161 & 0.0008 & 0.0856\n\\end{bmatrix}\n\ne\n\n\\hat{\\beta_j} \\sim N \\left( \\beta_j, \\hat{\\sigma^2} \\, a_{jj} \\right)\n\nem que a_{jj} é o j-ésimo elemento da diagonal da matriz (X^\\top X)^{-1}.\nConstruimos os intervalos de confiança da seguinte forma\n\nIC\\left( \\hat{\\beta_j}; \\gamma \\right) = \\hat{\\beta_j} \\pm t_{n-k; \\, \\gamma} \\cdot \\sqrt{\\hat{\\sigma^2} \\, a_{jj}}, \\quad n=97, \\, k=3, \\, \\gamma = 0,95\n\ne expomos na tabela a seguir:\n\n\nCode\ntibble(coefs = coef(fit2)) %&gt;%\n  mutate(LS = coefs + qt(.975, 94)*diag(invXtX),\n         LI = coefs - qt(.975, 94)*diag(invXtX)) %&gt;%\n  transmute(\n    beta = c(\"beta 1\", \"beta 2\", \"beta 5\"),\n    `[LI, LS]` = paste0(\"[\",round(LI,3), \", \", round(LS, 3),\"]\")) %&gt;%\n  knitr::kable(\n    align = c(\"c\"),\n    booktabs = TRUE,\n    longtable = TRUE,\n    linesep = \"\",\n    escape = FALSE,\n    digits = 2,\n    col.names = c(\"Beta\", \"[LI, LS]\")\n    ) %&gt;%\n  kableExtra::kable_styling(\n      position = \"center\",\n      latex_options = c(\"striped\", \"repeat_header\"),\n      stripe_color = \"gray!15\")\n\n\n\n\n\nBeta\n[LI, LS]\n\n\n\n\nbeta 1\n[0.531, 0.574]\n\n\nbeta 2\n[0.432, 0.44]\n\n\nbeta 5\n[0.498, 0.838]\n\n\n\n\n\n\n\nNota-se que nenhum dos intervalos compreende o valor 0, de modo que podemos dizer que os coeficientes escolhidos são todos diferentes de zero."
  }
]